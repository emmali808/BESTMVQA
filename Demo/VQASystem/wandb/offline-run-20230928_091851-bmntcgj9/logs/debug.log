2023-09-28 09:18:51,779 INFO    MainThread:116775 [wandb_setup.py:_flush():76] Current SDK version is 0.15.4
2023-09-28 09:18:51,779 INFO    MainThread:116775 [wandb_setup.py:_flush():76] Configure stats pid to 116775
2023-09-28 09:18:51,779 INFO    MainThread:116775 [wandb_setup.py:_flush():76] Loading settings from /home/coder/.config/wandb/settings
2023-09-28 09:18:51,779 INFO    MainThread:116775 [wandb_setup.py:_flush():76] Loading settings from /home/coder/projects/Demo/VQASystem/wandb/settings
2023-09-28 09:18:51,779 INFO    MainThread:116775 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-09-28 09:18:51,779 INFO    MainThread:116775 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-09-28 09:18:51,779 WARNING MainThread:116775 [wandb_setup.py:_flush():76] Could not save program above cwd: /home/coder/projects/PTUnifier-share/main.py
2023-09-28 09:18:51,779 INFO    MainThread:116775 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': None, 'program': '/home/coder/projects/PTUnifier-share/main.py'}
2023-09-28 09:18:51,779 INFO    MainThread:116775 [wandb_init.py:_log_setup():507] Logging user logs to /home/coder/projects/Demo/VQASystem/wandb/offline-run-20230928_091851-bmntcgj9/logs/debug.log
2023-09-28 09:18:51,779 INFO    MainThread:116775 [wandb_init.py:_log_setup():508] Logging internal logs to /home/coder/projects/Demo/VQASystem/wandb/offline-run-20230928_091851-bmntcgj9/logs/debug-internal.log
2023-09-28 09:18:51,780 INFO    MainThread:116775 [wandb_init.py:init():547] calling init triggers
2023-09-28 09:18:51,780 INFO    MainThread:116775 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {}
2023-09-28 09:18:51,780 INFO    MainThread:116775 [wandb_init.py:init():596] starting backend
2023-09-28 09:18:51,780 INFO    MainThread:116775 [wandb_init.py:init():600] setting up manager
2023-09-28 09:18:51,782 INFO    MainThread:116775 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: fork
2023-09-28 09:18:51,785 INFO    MainThread:116775 [wandb_init.py:init():606] backend started and connected
2023-09-28 09:18:51,790 INFO    MainThread:116775 [wandb_init.py:init():703] updated telemetry
2023-09-28 09:18:51,882 INFO    MainThread:116775 [wandb_init.py:init():736] communicating run to backend with 60.0 second timeout
2023-09-28 09:18:51,891 INFO    MainThread:116775 [wandb_init.py:init():787] starting run threads in backend
2023-09-28 09:18:55,150 INFO    MainThread:116775 [wandb_run.py:_console_start():2155] atexit reg
2023-09-28 09:18:55,150 INFO    MainThread:116775 [wandb_run.py:_redirect():2010] redirect: SettingsConsole.WRAP_RAW
2023-09-28 09:18:55,151 INFO    MainThread:116775 [wandb_run.py:_redirect():2075] Wrapping output streams.
2023-09-28 09:18:55,151 INFO    MainThread:116775 [wandb_run.py:_redirect():2100] Redirects installed.
2023-09-28 09:18:55,151 INFO    MainThread:116775 [wandb_init.py:init():828] run started, returning control to user process
2023-09-28 09:18:58,509 INFO    MainThread:116775 [wandb_run.py:_config_callback():1283] config_cb None None {'config/exp_name': 'task_finetune_vqa_vqa_rad', 'config/record_id': 1, 'config/seed': 0, 'config/datasets': ['vqa_vqa_rad'], 'config/loss_names/mlm': 0, 'config/loss_names/mim': 0, 'config/loss_names/umlm': 0, 'config/loss_names/umim': 0, 'config/loss_names/itm': 0, 'config/loss_names/itc': 0, 'config/loss_names/vqa': 1, 'config/loss_names/cls': 0, 'config/loss_names/mlc': 0, 'config/loss_names/irtr': 0, 'config/loss_names/clm': 0, 'config/batch_size': 64, 'config/train_transform_keys': ['clip'], 'config/val_transform_keys': ['clip'], 'config/image_size': 384, 'config/patch_size': 16, 'config/draw_false_image': 0, 'config/image_only': False, 'config/vqa_label_size': 498, 'config/mlc_label_size': 14, 'config/max_text_len': 32, 'config/tokenizer': '/home/coder/projects/PTUnifier-share/downloaded/biomed_roberta_base', 'config/vocab_size': 50265, 'config/whole_word_masking': True, 'config/mlm_prob': 0.15, 'config/draw_false_text': 0, 'config/sent_level': False, 'config/num_top_layer': 6, 'config/input_image_embed_size': 768, 'config/input_text_embed_size': 768, 'config/vit': 'ViT-B/16', 'config/hidden_size': 768, 'config/num_heads': 12, 'config/num_layers': 6, 'config/mlp_ratio': 4, 'config/drop_rate': 0.1, 'config/mim_prob': 0.75, 'config/mim_decoder_hidden_size': 384, 'config/mim_decoder_num_layers': 4, 'config/mim_decoder_num_heads': 6, 'config/norm_pix_loss': True, 'config/mim_layer': -1, 'config/optim_type': 'adamw', 'config/learning_rate': 5e-06, 'config/weight_decay': 0.01, 'config/decay_power': 1, 'config/max_epoch': 50, 'config/max_steps': 'None', 'config/warmup_steps': 0.1, 'config/end_lr': 0, 'config/lr_multiplier_head': 50, 'config/lr_multiplier_multi_modal': 5, 'config/get_recall_metric': False, 'config/resume_from': 'None', 'config/fast_dev_run': False, 'config/val_check_interval': 1.0, 'config/test_only': True, 'config/default_root_dir': 'checkpoints', 'config/data_root': '/home/coder/projects/PTUnifier-share/data/vqa_robot_demo', 'config/log_dir': 'result', 'config/per_gpu_batchsize': 16, 'config/num_gpus': 1, 'config/num_nodes': 1, 'config/load_path': '/home/coder/projects/PTUnifier-share/downloaded/ptu_finetune.ckpt', 'config/num_workers': 8, 'config/precision': 16, 'config/label_column_name': '', 'config/label_size/i_meth': 85, 'config/label_size/p_meth': 45, 'config/label_size/i_meth_label': 15, 'config/label_size/p_meth_label': 7, 'config/label_size/chexpert': 5, 'config/label_size/pnsa_pneumonia': 1, 'config/label_size/chemprot': 6, 'config/label_size/radnli_plus': 3, 'config/pseudo_vision_token_pool_size': 2048, 'config/pseudo_langauge_token_pool_size': 2048, 'config/num_pseudo_vision_tokens': 49, 'config/num_pseudo_langauge_tokens': 32, 'config/cl_temp': 0.1, 'config/data_frac': 1.0, 'config/vision_only': False, 'config/language_only': False, 'config/clm_max_text_len': 256, 'config/clm_do_sample': True, 'config/clm_num_beams': 5}
2023-09-28 09:19:01,540 WARNING MsgRouterThr:116775 [router.py:message_loop():77] message_loop has been closed
